<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Exemplum eorum quae facere potes</title>

    <!------------------------------------------------------------>
    <!-- You are free to use, change, and remix this template however you want! -->
    <!-- This is a basic setup to make tool imports handy. -->
    <!-- Adapt it to match your own visualization story and design. -->
    <!-- so your project doesn’t look exactly the same as everyone else's :) -->
    <!------------------------------------------------------------>

    <!-- Bootstrap Framework: if you want to make HTML handling simpler -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />

    <link rel="stylesheet" href="style.css" />

    <!-- Google Font: DM Serif Display + Source Sans 3 (an example set of fonts that go together) -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=Source+Sans+3:ital,wght@0,200..900;1,200..900&display=swap"
      rel="stylesheet"
    />

    <!-- Loading Vega, Vega-Lite, Vega-Embed -->
    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>

    <!-- Loading D3 -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
  </head>

  <body class="bg-light">
    <div class="container py-5">
      <h1 class="text-center mb-3 mt-5">Exemplum eorum quae facere potes</h1>
      <h5 class="text-center mb-5">538astin Santy</h5>

      <div class="row g-4 mb-4">
        <div class="col-md-6 offset-md-3">
          <p>
            Composui nonnullas notas cum exemplis quae demonstrant quomodo
            imagines visuales creatas per varia instrumenta quae in classe
            didicimus -- Vega-Lite, D3, Observable Embedding, et Tableau -- in
            paginam interretialem transferre possis. Ingredientia principalia
            cuiusque progrediendo illustrabo.
          </p>
        </div>
      </div>

      <div class="row g-4 mb-4">
        <div class="col-md-12 text-center">
          <h3>Vega-Lite → Web</h3>
        </div>
      </div>

      <!-- ===== Vega-Lite variants ===== -->
      <div class="row g-4 mb-4">
        <!-- VL #1: Minimal inline data -->
        <div class="col-md-4">
          <div class="card shadow">
            <div class="card-body">
              <div id="vl-basic" style="height: 300px; width: 100%"></div>
            </div>
          </div>
        </div>

        <!-- VL #2: fetch('data.csv') + manual CSV parser -->
        <div class="col-md-4">
          <div class="card shadow">
            <div class="card-body">
              <div id="vl-fetch" style="height: 300px; width: 100%"></div>
            </div>
          </div>
        </div>

        <!-- VL #3: URL-based CSV -->
        <div class="col-md-4">
          <div class="card shadow">
            <div class="card-body">
              <div id="vl-url" style="height: 300px; width: 100%"></div>
            </div>
          </div>
        </div>
      </div>

      <div class="row g-4 mb-4">
        <div class="col-md-12 text-center text-muted">
          Vega-Lite visualizations: (1) inline data, (2) CSV via
          <code>fetch()</code>, (3) CSV via Vega-Lite <code>data.url</code>.
        </div>
      </div>
      <div class="row g-4 mb-5">
        <div class="col-md-6 offset-md-3">
          <p>
            Vega-Lite is the first tool we've been playing around with in class.
            To get Vega-Lite visualizations onto a web page, all you need to do
            is import three libraries -- Vega, Vega-Lite, and
            <a href="https://github.com/vega/vega-embed" target="_blank"
              >Vega-Embed</a
            >
            -- into your HTML file, and then render your spec into a
            <code>div</code> using something like
            <code>vegaEmbed('#vis', spec)</code>. Here, I've shown three
            different Vega-Lite visualizations: the first one uses inline data,
            while the other two load data from <code>data.csv</code>, either
            using the JavaScript <code>fetch()</code> method or Vega-Lite's
            built-in URL loading.
          </p>
        </div>
      </div>

      <div class="row g-4 mb-4">
        <div class="col-md-12 text-center">
          <h3>D3 → Web</h3>
        </div>
      </div>

      <!-- ===== D3 variants ===== -->
      <div class="row g-4 mb-4">
        <!-- D3 #1: Minimal inline data -->
        <div class="col-md-4">
          <div class="card shadow">
            <div class="card-body">
              <svg id="d3-basic" style="height: 300px"></svg>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="card shadow">
            <div class="card-body">
              <svg id="d3-fetch" style="height: 300px"></svg>
            </div>
          </div>
        </div>
        <!-- D3 #2: fetch('data.csv') + D3's own parser -->
        <div class="col-md-4">
          <div class="card shadow">
            <div class="card-body">
              <svg id="d3-csv" style="height: 300px"></svg>
            </div>
          </div>
        </div>
      </div>
      <div class="row g-4 mb-4">
        <!-- D3 #3: D3 CSV -->
        <div class="col-md-12 text-center text-muted">
          D3 visualizations without any data, using fetch and using native D3
          CSV.
        </div>
      </div>
      <div class="row g-4 mb-5">
        <div class="col-md-6 offset-md-3">
          <p>
            Next, we'll look at D3. As we know, D3 is a bit more involved than
            Vega-Lite when it comes to building a visualization -- but that's
            because it treats the web as a first-class citizen. That comes to
            our advantage here as we're putting D3 visualizations on the web --
            all you need to do is import the D3 JavaScript library into your
            HTML file and then write D3 code as usual. Here, I'm showing the
            same three data-loading setups: inline data, using
            <code>fetch()</code>, and using D3's built-in CSV parser.
          </p>
          <p>
            D3 and the web talk to each other through the DOM, so when it comes
            to visualizations, graphics, animations, and interactivity on web
            pages, D3 really nails it. We'll see a more complex example after we
            cover incorporating embeddings through Observable. Be sure to check
            out
            <a href="https://observablehq.com/@d3/gallery" target="_blank"
              >D3 Gallery</a
            >
            for inspiration on what you can do with D3.
          </p>
        </div>
      </div>

      <div class="row g-4 mb-4">
        <div class="col-md-12 text-center">
          <h3>Observable → Web</h3>
        </div>
      </div>

      <!-- ===== Observable Embedding variants ===== -->
      <!-- Observable #1: Single Cell -->
      <div class="row g-4 mb-4">
        <div class="col-md-8 offset-md-2">
          <div class="card shadow">
            <div class="card-body">
              <div class="viz-wrap hans-rosling-wrap">
                <div
                  class="obs-chart"
                  id="observablehq-chartAnimate-461903df"
                ></div>

                <link
                  rel="stylesheet"
                  href="https://cdn.jsdelivr.net/npm/@observablehq/inspector@5/dist/inspector.css"
                />
                <script type="module">
                  import {
                    Runtime,
                    Inspector,
                  } from "https://cdn.jsdelivr.net/npm/@observablehq/runtime@5/dist/runtime.js";
                  import define from "https://api.observablehq.com/d/b5faec8b08fa031c.js?v=4";
                  new Runtime().module(define, (name) => {
                    if (name === "chartAnimate")
                      return new Inspector(
                        document.querySelector(
                          "#observablehq-chartAnimate-461903df",
                        ),
                      );
                  });
                </script>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="row g-4 mb-4">
        <div class="col-md-12 text-center text-muted">
          Embedding a single cell from Observable.
        </div>
      </div>

      <!-- Observable #2: Multi Cell -->
      <div class="row g-4 mb-4">
        <div class="col-md-8 offset-md-2">
          <div class="card shadow">
            <div class="card-body">
              <div class="viz-wrap multicell">
                <!-- Observable Multicell Embeddings Start -->
                <!-- Embeddings from: https://observablehq.com/@lelkin/d3-tutorial-spring-2025 -->

                <!-- Step 1: Club two divs together -->
                <div
                  class="obs-controls"
                  id="observablehq-viewof-yearDynamic-136a1331"
                ></div>
                <div
                  class="obs-chart"
                  id="observablehq-chartDynamic-69afaccb"
                ></div>

                <link
                  rel="stylesheet"
                  href="https://cdn.jsdelivr.net/npm/@observablehq/inspector@5/dist/inspector.css"
                />
                <script type="module">
                  import {
                    Runtime,
                    Inspector,
                  } from "https://cdn.jsdelivr.net/npm/@observablehq/runtime@5/dist/runtime.js";
                  import define from "https://api.observablehq.com/d/b5faec8b08fa031c.js?v=4";
                  new Runtime().module(define, (name) => {
                    // Step 2: Club the two if statements inside runtime together, as follows:
                    if (name === "chartDynamic")
                      return new Inspector(
                        document.querySelector(
                          "#observablehq-chartDynamic-69afaccb",
                        ),
                      );
                    if (name === "viewof yearDynamic")
                      return new Inspector(
                        document.querySelector(
                          "#observablehq-viewof-yearDynamic-136a1331",
                        ),
                      );
                    // Step 3: Add return true;
                    return true;
                  });
                </script>

                <!-- Observable Multicell Embeddings End -->
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="row g-4 mb-4">
        <div class="col-md-12 text-center text-muted">
          Embedding multiple cells from Observable.
        </div>
      </div>
      <div class="row g-4 mb-5">
        <div class="col-md-6 offset-md-3">
          <p>
            Unlike the previous two, which are visualization frameworks,
            Observable is a runtime. That said, Observable provides a way to
            embed cells directly into a web page. To do this, click the three
            dots in the top-right corner of a cell, select <em>Embed</em>,
            choose <em>Runtime with JavaScript</em>, copy the generated code,
            and paste it into a <code>div</code>. You can also embed multiple
            cells that talk to each other (that is, share state between them)
            with some careful code manipulation.
          </p>

          <p>
            With Observable embedding, you can offload the work of managing
            libraries to Observable, which runs everything on their end and
            returns the final output. The flip side is that you have less
            control and more limited interaction between your web page and the
            embedded cells. For example, click
            <em>Ka-boom!!!</em>
            in the visualization below to see what you can do with native D3
            compared to Observable embedding for the same Hans Rosling–style
            visualization. Or notice how the year slider has been placed above
            the year text inside the visualization. Such customizations are
            enabled by the ability to directly manipulate the DOM elements
            created by D3, which is not possible when working with Observable
            embedding.
          </p>
        </div>
      </div>

      <div class="row g-4 mb-4">
        <div class="col-md-8 offset-md-2">
          <div class="card shadow" id="hans-rosling-card">
            <div class="card-body">
              <div class="viz-wrap hans-rosling-native">
                <div class="hans-rosling-controls">
                  <div class="hans-rosling-header">
                    <div class="hans-rosling-actions">
                      <button
                        id="hans-rosling-explode"
                        class="btn btn-md btn-outline-danger"
                        type="button"
                      >
                        Ka‑boom!!!
                      </button>
                      <button
                        id="hans-rosling-reset"
                        class="btn btn-md btn-outline-primary"
                        type="button"
                      >
                        Ka‑zip!
                      </button>
                    </div>
                  </div>
                </div>
                <div id="hans-rosling" aria-label="Gapminder bubble chart">
                  <div class="hans-rosling-slider-overlay">
                    <input
                      id="hans-rosling-year"
                      class="form-range"
                      type="range"
                      min="1960"
                      max="2010"
                      step="5"
                      value="1960"
                      aria-label="Gapminder year"
                    />
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="col-md-12 text-center text-muted">
        D3 native interacting with DOM elements to create fancy animations.
      </div>

      <div class="row g-4 mb-4 mt-5">
        <div class="col-md-12 text-center">
          <h3>Tableau → Web</h3>
        </div>
      </div>

      <!-- ===== Tableau ===== -->
      <div class="row g-4 mb-4 justify-content-center">
        <div class="col-md-6 col-lg-4">
          <div class="card shadow">
            <div class="card-body">
              <div class="vis-wrap">
                <div
                  class="tableauPlaceholder"
                  id="viz1761580567182"
                  style="position: relative"
                >
                  <noscript
                    ><a href="#"
                      ><img
                        alt="Sheet 1 "
                        src="https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;te&#47;test_17615805316300&#47;Sheet1&#47;1_rss.png"
                        style="border: none" /></a></noscript
                  ><object class="tableauViz" style="display: none">
                    <param
                      name="host_url"
                      value="https%3A%2F%2Fpublic.tableau.com%2F"
                    />
                    <param name="embed_code_version" value="3" />
                    <param name="site_root" value="" />
                    <param name="name" value="test_17615805316300&#47;Sheet1" />
                    <param name="tabs" value="no" />
                    <param name="toolbar" value="yes" />
                    <param
                      name="static_image"
                      value="https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;te&#47;test_17615805316300&#47;Sheet1&#47;1.png"
                    />
                    <param name="animate_transition" value="yes" />
                    <param name="display_static_image" value="yes" />
                    <param name="display_spinner" value="yes" />
                    <param name="display_overlay" value="yes" />
                    <param name="display_count" value="yes" />
                    <param name="language" value="en-US" />
                    <param name="filter" value="publish=yes" />
                  </object>
                </div>
                <script type="text/javascript">
                  var divElement = document.getElementById("viz1761580567182");
                  var vizElement = divElement.getElementsByTagName("object")[0];
                  vizElement.style.width = "100%";
                  vizElement.style.height =
                    divElement.offsetWidth * 0.75 + "px";
                  var scriptElement = document.createElement("script");
                  scriptElement.src =
                    "https://public.tableau.com/javascripts/api/viz_v1.js";
                  vizElement.parentNode.insertBefore(scriptElement, vizElement);
                </script>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="row g-4 mb-4">
        <div class="col-md-12 text-center text-muted">
          Tableau dashboard embed as a single-panel example.
        </div>
      </div>
      <div class="row g-4">
        <div class="col-md-6 offset-md-3">
          <p>
            Tableau provides a way to create visualizations without touching
            code. Like Observable, Tableau also allows you to embed your
            visualizations directly into a web page. To do this, go to
            <em>File</em> → <em>Save Tableau Public As</em> (or
            <em>Publish As</em> on Web Tableau) → <em>Share</em> →
            <em>Embed Code</em>, copy the generated code, and paste it into your
            HTML file.
          </p>
        </div>
      </div>
    </div>
    <footer class="bg-dark text-light py-4 mt-5">
      <div class="container text-center">
        <small class="text-secondary">CSE 442 Data Visualization</small>
        <p class="mb-1">University of Washington</p>
      </div>
    </footer>
  </body>

  <script src="/js/vl-basic.js"></script>
  <script src="/js/vl-fetch.js"></script>
  <script src="/js/vl-url.js"></script>

  <script src="/js/d3-basic.js"></script>
  <script src="/js/d3-fetch.js"></script>
  <script src="/js/d3-csv.js"></script>
  <script src="/js/hans-rosling-d3.js"></script>

  <script>
    const fitObservableChart = (chartId) => {
      const container = document.getElementById(chartId);
      if (!container) return;

      const fit = () => {
        const target = container.querySelector("svg, canvas");
        if (!target) return;

        let targetWidth = 0;
        let targetHeight = 0;

        if (target.tagName.toLowerCase() === "canvas") {
          targetWidth = target.width || target.getBoundingClientRect().width;
          targetHeight = target.height || target.getBoundingClientRect().height;
        } else {
          const attrWidth = parseFloat(target.getAttribute("width"));
          const attrHeight = parseFloat(target.getAttribute("height"));
          if (Number.isFinite(attrWidth) && Number.isFinite(attrHeight)) {
            targetWidth = attrWidth;
            targetHeight = attrHeight;
          } else if (target.viewBox && target.viewBox.baseVal) {
            targetWidth = target.viewBox.baseVal.width;
            targetHeight = target.viewBox.baseVal.height;
          } else {
            const box = target.getBoundingClientRect();
            targetWidth = box.width;
            targetHeight = box.height;
          }
        }

        const containerWidth = container.clientWidth;
        const containerHeight = container.clientHeight;

        if (
          !targetWidth ||
          !targetHeight ||
          !containerWidth ||
          !containerHeight
        ) {
          return;
        }

        const scale = Math.min(
          containerWidth / targetWidth,
          containerHeight / targetHeight,
        );

        target.style.transform = `scale(${scale})`;
        target.style.transformOrigin = "top left";
        target.style.width = `${targetWidth}px`;
        target.style.height = `${targetHeight}px`;
      };

      const observer = new ResizeObserver(fit);
      observer.observe(container);

      const retry = () => {
        fit();
        if (!container.querySelector("svg, canvas")) {
          requestAnimationFrame(retry);
        }
      };

      retry();
    };

    window.addEventListener("load", () => {
      fitObservableChart("observablehq-chartAnimate-461903df");
      fitObservableChart("observablehq-chartDynamic-69afaccb");
    });
  </script>
</html>
